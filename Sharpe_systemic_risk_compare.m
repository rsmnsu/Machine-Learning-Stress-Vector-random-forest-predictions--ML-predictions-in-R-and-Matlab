
clc
clear
%% Import data from spreadsheet
% Script for importing data from the following spreadsheet:
%
%    Workbook: C:\Users\Mihan\Desktop\Working\Stock_bond.xlsx
%    Worksheet: Sheet2
%
% To extend the code for use with different selected data or a different
% spreadsheet, generate a function instead of a script.

% Auto-generated by MATLAB on 2018/09/12 12:16:08

%% Import the data
[~, ~, raw] = xlsread('C:\Users\Mihan\Desktop\Working\Stock_bond.xlsx','Sheet2');
raw(cellfun(@(x) ~isempty(x) && isnumeric(x) && isnan(x),raw)) = {''};

%% Replace non-numeric cells with NaN
R = cellfun(@(x) ~isnumeric(x) && ~islogical(x),raw); % Find non-numeric cells
raw(R) = {NaN}; % Replace non-numeric cells

%% Create output variable
data = reshape([raw{:}],size(raw));

%% Allocate imported array to column variable names
Stock = data(:,1);
Bond = data(:,2);
SystemicRisk = data(1:end-1,3);

%% Clear temporary variables
clearvars data raw R;
%% start work
Bond = log(Bond); 
Bond= 100*(trimr(Bond,1,0)-trimr(Bond,0,1));
Stock = log(Stock); 
Stock= 100*(trimr(Stock,1,0)-trimr(Stock,0,1));
w=100;
stdstock = zeros(length(Stock),1);
for i= w+ 1: length(Stock)
stdstock(i,1)=std(Stock(i-w:i-1,1));
end
stdstock=trimr(stdstock,100,0);
stdstock0=movstd(Stock,100);
Bond0=trimr(Bond,100,0);
Stock0=trimr(Stock,100,0);
SystemicRisk0=trimr(SystemicRisk,100,0);

%% with moving standard deviation

SharpeRatio= zscore((Stock-Bond)./stdstock0);
SystemicRatio= zscore((Stock-Bond)./SystemicRisk);
Addedrisk= SharpeRatio+SystemicRatio; 
Difference= SharpeRatio-SystemicRatio;

plot (movmean(SharpeRatio,200))
hold on
plot(movmean(SystemicRatio,200))
plot(movmean(Difference,200))
plot(movmean(Addedrisk,200))
hold off





